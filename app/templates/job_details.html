{% extends "base.html" %}

{% block title %}{{ job.job_title if job else 'Job Details' }} - Job Search{% endblock %}

{% block content %}
<section class="job-details-page">
    {% if error %}
    <div class="alert alert-error">{{ error }}</div>
    {% endif %}
    
    {% if job %}
    <div class="job-details-header">
        <div class="header-top">
            <div class="header-content">
                {% if job.employer_logo %}
                <img src="{{ job.employer_logo }}" alt="{{ job.employer_name }}" class="company-logo-large" onerror="this.style.display='none';">
                {% endif %}
                <div>
                    <h1>{{ job.job_title }}</h1>
                    <p class="company-name">{{ job.employer_name }}</p>
                    <div class="job-meta">
                        <span class="meta-tag location">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                            {{ job.job_city or 'N/A' }}{% if job.job_state %}, {{ job.job_state }}{% endif %}{% if job.job_country %}, {{ job.job_country }}{% endif %}
                        </span>
                        {% if job.job_is_remote %}
                        <span class="meta-tag remote">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                            Remote Available
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            {% if job.job_apply_link %}
            <a href="{{ job.job_apply_link }}" target="_blank" rel="noopener" class="btn btn-primary btn-large">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg>
                Apply Now
            </a>
            {% endif %}
        </div>
    </div>
    
    <div class="job-details-content">
        <div class="job-info-cards">
            <div class="info-card">
                <div class="info-card-icon">üíº</div>
                <h4>Employment Type</h4>
                <p>{{ job.job_employment_type or 'Not specified' }}</p>
            </div>
            
            {% if job.job_min_salary or job.job_max_salary %}
            <div class="info-card">
                <div class="info-card-icon">üí∞</div>
                <h4>Salary Range</h4>
                <p>
                    {% if job.job_min_salary %}${{ "{:,.0f}".format(job.job_min_salary) }}{% endif %}
                    {% if job.job_min_salary and job.job_max_salary %} - {% endif %}
                    {% if job.job_max_salary %}${{ "{:,.0f}".format(job.job_max_salary) }}{% endif %}
                </p>
            </div>
            {% endif %}
            
            {% if job.job_posted_at_datetime_utc %}
            <div class="info-card">
                <div class="info-card-icon">üìÖ</div>
                <h4>Posted</h4>
                <p>{{ job.job_posted_at_datetime_utc[:10] }}</p>
            </div>
            {% endif %}
            
            {% if job.job_offer_expiration_datetime_utc %}
            <div class="info-card">
                <div class="info-card-icon">‚è∞</div>
                <h4>Expires</h4>
                <p>{{ job.job_offer_expiration_datetime_utc[:10] }}</p>
            </div>
            {% endif %}
        </div>
        
        <div class="job-description-full">
            <h2 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                Job Description
            </h2>
            <div class="description-text">{{ job.job_description }}</div>
        </div>
        
        {% if job.job_highlights %}
        <div class="job-highlights">
            {% if job.job_highlights.Qualifications %}
            <div class="highlight-section">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path d="M6 12v5c3 3 9 3 12 0v-5"></path></svg>
                    Qualifications
                </h3>
                <ul>
                    {% for qual in job.job_highlights.Qualifications %}
                    <li>{{ qual }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            {% if job.job_highlights.Responsibilities %}
            <div class="highlight-section">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                    Responsibilities
                </h3>
                <ul>
                    {% for resp in job.job_highlights.Responsibilities %}
                    <li>{{ resp }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            {% if job.job_highlights.Benefits %}
            <div class="highlight-section">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path></svg>
                    Benefits
                </h3>
                <ul>
                    {% for benefit in job.job_highlights.Benefits %}
                    <li>{{ benefit }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
        {% endif %}
        
        <div class="detail-actions">
            <a href="{{ url_for('jobs.search') }}" class="btn btn-secondary">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
                Back to Search
            </a>
            {% if job.job_apply_link %}
            <a href="{{ job.job_apply_link }}" target="_blank" rel="noopener" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg>
                Apply Now
            </a>
            {% endif %}
        </div>
    </div>
    {% else %}
    <div class="no-results">
        <div class="no-results-icon">üòï</div>
        <h3>Job not found</h3>
        <p>This job posting may no longer be available or the link might be incorrect.</p>
        <a href="{{ url_for('jobs.search') }}" class="btn btn-primary">Back to Search</a>
    </div>
    {% endif %}
</section>
{% endblock %}
